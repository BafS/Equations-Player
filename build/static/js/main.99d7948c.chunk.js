(this.webpackJsonpphase=this.webpackJsonpphase||[]).push([[0],{164:function(e,t,n){e.exports=function(){return new Worker(n.p+"112805e7016e0f52e49b.worker.js")}},166:function(e,t,n){e.exports=n(252)},171:function(e,t,n){},246:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var a=n(21),r=n.n(a),o=n(161),i=n.n(o),l=(n(171),n(93)),c=n(162),s=n.n(c),u=(n(246),n(165)),m=r.a.forwardRef((function(e,t){var n=e.handleClick,a=e.children,o=Object(u.a)(e,["handleClick","children"]);return r.a.createElement("button",Object.assign({className:"btn"},o,{onClick:n}),a)})),f=n(134),d=n(156),h=["INPUT"],v=function(e,t){switch(t.type){case"ACTION_SET_KEY_DOWN":return Object(d.a)({},e,Object(f.a)({},t.key,!0));case"ACTION_SET_KEY_UP":return Object(d.a)({},e,Object(f.a)({},t.key,!1));default:return e}},b=function(e,t){if(!Array.isArray(e))throw new Error("The first parameter to `useKeyboardShortcut` must be an ordered array of `KeyboardEvent.key` strings.");if(!e.length)throw new Error("The first parameter to `useKeyboardShortcut` must contain at least one `KeyboardEvent.key` string.");if(!t||"function"!==typeof t)throw new Error("The second parameter to `useKeyboardShortcut` must be a function that will be invoked when the keys are pressed.");var n=e.reduce((function(e,t){return e[t.toLowerCase()]=!1,e}),{}),r=Object(a.useReducer)(v,n),o=Object(l.a)(r,2),i=o[0],c=o[1],s=Object(a.useCallback)((function(e){var t=e.key,n=e.target,a=e.repeat,r=t.toLowerCase();a||h.includes(n.tagName)||void 0===i[r]||!1===i[r]&&c({type:"ACTION_SET_KEY_DOWN",key:r})}),[i]),u=Object(a.useCallback)((function(e){var t=e.key,n=e.target,a=t.toLowerCase();h.includes(n.tagName)||void 0===i[a]||!0===i[a]&&c({type:"ACTION_SET_KEY_UP",key:a})}),[i]);Object(a.useEffect)((function(){Object.values(i).filter((function(e){return!e})).length||t(i)}),[t,i]),Object(a.useEffect)((function(){return window.addEventListener("keydown",s,!0),function(){return window.removeEventListener("keydown",s,!0)}}),[s]),Object(a.useEffect)((function(){return window.addEventListener("keyup",u,!0),function(){return window.removeEventListener("keyup",u,!0)}}),[u])},p={background:"#000",function:"rgba(60, 169, 248, .8)",overflow:"rgba(255, 0, 0, .75)",strokeStyle:"rgba(200, 200, 200, .25)",text:"rgba(200, 200, 200, .9)",peaks:{top:"rgba(255, 50, 50, .2)",bottom:"rgba(50, 255, 50, .2)"}},w={lineDash:[3,6],lineWidth:1,font:"12px monospace"};function E(e,t){var n=t.getContext("2d");if(!n)throw new Error("Context is not available");n.fillStyle=p.background,n.fillRect(0,0,t.width,t.height);var a=1e3*e.duration,r=t.width/a;n.font=w.font;var o=1e3/Math.pow(10,Math.floor(Math.log(2*r)*Math.LOG10E+1));n.strokeStyle=p.strokeStyle,n.lineWidth=w.lineWidth,n.setLineDash(w.lineDash);for(var i=0;i<a;i+=o){var l=Math.round(i*r);n.fillStyle=p.text,n.fillText("".concat(i,"ms"),i*r+4,t.height-5),i>0&&(n.beginPath(),n.moveTo(l+.5,0),n.lineTo(l+.5,t.height),n.stroke(),n.fillStyle="rgba(100, 100, 100)",n.fillRect(l,0,1,25),n.fillRect(l,t.height-25,1,25))}return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.getContext("2d");if(!a)throw new Error("Context is not available");n&&a.clearRect(0,0,t.width,t.height);var r=t.width-1,o=t.height-1;a.lineWidth=w.lineWidth,a.strokeStyle=p.strokeStyle;var i=o/2;a.setLineDash(w.lineDash);for(var l=1;l<10;++l){a.beginPath();var c=Math.round(l*(i/10*2));a.moveTo(0,.5+c),a.lineTo(r,.5+c),a.stroke()}a.fillStyle="rgba(50, 50, 50, .9)",a.fillRect(0,i+.5,r,1),a.strokeStyle=p.function,a.setLineDash([]),a.beginPath(),a.lineWidth=1.5*w.lineWidth;var s=(r+1)/e.length,u=-o/2,m=null,f=[1/0,-1/0];e.forEach((function(e,t){(e-=1)>f[1]?f[1]=e:e<f[0]&&(f[0]=e),t*=s,m&&e>0?(a.fillStyle=p.overflow,a.fillRect(t-1,0,1,3)):m&&e<-2&&(a.fillStyle=p.overflow,a.fillRect(t-1,o,1,-3)),e*=u,m&&(a.moveTo(m[0],m[1]),a.lineTo(t,e)),m=[t,e]})),a.stroke(),a.fillStyle=p.text;var d=Math.floor(f[1]*u),h=Math.ceil(f[0]*u);return a.fillText(" \xdb",r-20,Math.max(15,d-6)),a.fillText("-\xdb",r-20,Math.min(o-8,h+15)),a.fillStyle=p.peaks.bottom,a.fillRect(0,d,r,1),a.fillStyle=p.peaks.top,a.fillRect(0,h,r,1),t}(e.getChannelData(0),t)}var g=function(e){var t=e.buffer,n=e.options,o=(n=void 0===n?{width:800,height:350}:n).width,i=n.height,l=Object(a.useRef)(null);return Object(a.useEffect)((function(){l.current&&E(t,l.current)}),[t,o]),r.a.createElement("canvas",{ref:l,width:o,height:i})},k=n(163),y=n.n(k),O=n(164),j=n.n(O);var C=function(e){var t=e.buffer,n=e.options,o=(n=void 0===n?{width:800,height:350}:n).width,i=n.height,c=Object(a.useState)(!1),s=Object(l.a)(c,2),u=s[0],f=s[1],d=Object(a.useState)(!1),h=Object(l.a)(d,2),v=h[0],p=h[1];return Object(a.useEffect)((function(){var e,n,a=new AudioContext;u?((e=a.createBufferSource()).buffer=t,e.connect(a.destination),e.loop=v,e.onended=function(){return f(!1)},e.start()):null===(n=e)||void 0===n||n.stop();return function(){var t;return null===(t=e)||void 0===t?void 0:t.stop()}}),[u]),b(["Control","L"],Object(a.useCallback)((function(){f((function(e){return!e}))}),[f])),r.a.createElement("div",{className:"player"},r.a.createElement(g,{buffer:t,options:{width:o,height:i}}),r.a.createElement("div",{className:"panel"},r.a.createElement("span",{className:"text-dark text-sm"},"Length: ",t.duration,"s | "),r.a.createElement("span",{className:"text-dark text-sm"},"Frequency: ",t.sampleRate,"hz | "),r.a.createElement(m,{className:"btn btn-sm",handleClick:function(){p(!1),f((function(e){return!e}))}},u?"stop":"play"),r.a.createElement("span",null," "),r.a.createElement(m,{className:"btn btn-sm",handleClick:function(){p(!0),f((function(e){return!e}))}},u?"stop":"loop"),r.a.createElement("span",{className:"text-dark text-sm"}," (Ctrl+L) | "),r.a.createElement(m,{className:"btn btn-sm",handleClick:function(){var e;(e=t,y.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=new j.a;n.onmessage=function(e){var n=new Blob([e.data.buffer],{type:"audio/wav"});t(n)};for(var a=[],r=0;r<e.numberOfChannels;++r)a.push(e.getChannelData(r));n.postMessage({pcmArrays:a,config:{sampleRate:e.sampleRate}})})));case 1:case"end":return t.stop()}}))).then((function(e){return function(e,t){if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var n=document.createElement("a");document.body.appendChild(n);var a=window.URL.createObjectURL(e);n.href=a,n.download=t,n.click(),setTimeout((function(){window.URL.revokeObjectURL(a),document.body.removeChild(n)}),0)}}(e,"phase-generated.wav")}))}},"download")))},N=function(e){var t=e.defaultValue,n=e.handleChange,a=e.min,o=void 0===a?void 0:a,i=e.max,l=void 0===i?void 0:i;return r.a.createElement("input",{className:"input",min:o,max:l,type:"number",placeholder:"Search",defaultValue:t,onChange:n})},S=function(){return r.a.createElement("div",{className:"text-dark placeholder"},r.a.createElement("p",{className:"main"},"Generates a sound whose amplitude is given by ",r.a.createElement("em",null,"F(t)")," with time ",r.a.createElement("em",null,"t")," (in ms) from",r.a.createElement("em",null," 0")," to ",r.a.createElement("em",null,"t",r.a.createElement("sub",null,"max"))),r.a.createElement("p",{className:"text-sm"},'"process code" button (ctrl+1) will evaluate the whole code'),r.a.createElement("p",{className:"text-sm"},'"process line" (ctrl+2) will evaluate the code until the cursor line'),r.a.createElement("p",{className:"text-sm"},'("return" is added automatically to the last line if there is none)'))},x=function(){var e,t=["// Javascript code to evaluate your function F(t)","","// Main waveforms (https://en.wikipedia.org/wiki/Waveform)","(-1) ** Math.floor(2 * 440 * t); // square","(440 * t - Math.round(440 * t)) * 2; // sawtooth","4 * Math.abs(440 * t - Math.round(t*440)) - 1; // triangle","Math.sin(440 * t * Math.PI * 2); // sine"].join("\n"),n=Object(a.useState)(t),o=Object(l.a)(n,2),i=o[0],c=o[1],u=Object(a.useState)(null),f=Object(l.a)(u,2),d=f[0],h=f[1],v=Object(a.useState)(window.innerWidth),p=Object(l.a)(v,2),w=p[0],E=p[1],g=Object(a.useState)(100),k=Object(l.a)(g,2),y=k[0],O=k[1],j=Object(a.useState)(""),x=Object(l.a)(j,2),L=x[0],R=x[1],T=function(e,t){var n=Object(a.useRef)(),r=Object(a.useState)(0),o=Object(l.a)(r,2),i=o[0],c=o[1];return Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(i>0){var e=setTimeout((function(){c(0),n.current&&n.current()}),t);return function(){return clearTimeout(e)}}}),[i,t]),function(){return c((function(e){return e+1}))}}((function(){return E(window.innerWidth)}),500),M=function(e){var t=e.trim().split("\n"),n=t.pop();if(n){n.trimStart().startsWith("return")||n.trimStart().startsWith("//")||(n="return ".concat(n));var a=t.concat(n).join("\n");try{var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;console.time("generation");for(var n=new AudioContext,a=t/1e3*n.sampleRate,r=n.createBuffer(2,a,n.sampleRate),o=new Function("t",e),i=0,l=0;l<r.numberOfChannels;l++)for(var c=r.getChannelData(l),s=0;s<r.length;++s){var u=o(s/n.sampleRate);Math.abs(u)>i&&(i=Math.abs(u)),c[s]=u}return console.timeEnd("generation"),r}(a,y);h(r),R("")}catch(o){R(o.toString()),console.error(o)}}},W=function(){return M(i)};return Object(a.useLayoutEffect)((function(){return window.addEventListener("resize",T),function(){return window.removeEventListener("resize",T)}})),b(["Control","1"],Object(a.useCallback)((function(){return W()}),[i])),b(["Control","2"],Object(a.useCallback)((function(){return function(){var t,n=null===(t=e)||void 0===t?void 0:t.getPosition();if(n){var a=n.lineNumber,r=e.getValue().trim().split("\n").slice(0,a);M(r.join("\n"))}}()}),[])),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"text-title"},"PHASE"),r.a.createElement("div",{className:"main-plot"},d?r.a.createElement(C,{buffer:d,options:{width:w,height:350}}):r.a.createElement(S,null)),r.a.createElement("div",{className:"main-panel"},r.a.createElement("div",{className:"left"},r.a.createElement("em",null,"t",r.a.createElement("sub",null,"max")),":",r.a.createElement(N,{min:0,max:1e5,defaultValue:y,handleChange:function(e){return O(+e.target.value)}}),"ms"),r.a.createElement("div",{className:"right"},r.a.createElement(m,{handleClick:W},"process code"),r.a.createElement("span",{className:"text-dark text-sm"}," (Ctrl+1)"),r.a.createElement("br",null),r.a.createElement("span",{className:"text-dark text-sm"},"process current line (Ctrl+2)"))),r.a.createElement("div",{className:"editor-panel"},r.a.createElement("span",null,r.a.createElement("em",null,"F(t)")," = "),L?r.a.createElement("div",{className:"text-error"},L):"",r.a.createElement(s.a,{language:"javascript",theme:"vs-dark",value:i,options:{selectOnLineNumbers:!0,automaticLayout:!0,minimap:{enabled:!1},lineDecorationsWidth:".2ch",lineNumbersMinChars:3,fontSize:13,scrollBeyondLastLine:!1,hideCursorInOverviewRuler:!0},onChange:c,editorDidMount:function(t){(e=t).focus()}})),r.a.createElement("div",{className:"footer-panel"},r.a.createElement("div",{className:"left"},r.a.createElement("span",{className:"btn-link",onClick:function(){return c("")}},"clear editor"),r.a.createElement("span",{className:"btn-link",onClick:function(){return c(t)}},"load main waveforms")),r.a.createElement("div",{className:"right"},"Fork me on ",r.a.createElement("a",{href:"https://github.com/BafS/Phase"},"github"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[166,1,2]]]);